---
description: Documents data flow and state updates between major game components including Battlefield, CardHand, GameInterface, PlayerHUD and TurnManager
globs: **/components/**/*.{ts,tsx},**/features/**/*.{ts,tsx},**/game/**/*.{ts,tsx}
alwaysApply: false
---


# Component-Dataflow

## Core Game State Flow

The game state flows between five major components that manage different aspects of gameplay:

### Battlefield -> TurnManager
- Sends unit position updates and combat results
- Notifies when combat phase completes
- Updates zone control status
- Reports crisis event triggers

### TurnManager -> PlayerHUD 
- Updates current phase (Draw/Energy/Main/Combat/End)
- Sends resource updates (Energy/Momentum)
- Notifies valid action types for current phase
- Triggers hero ability availability

### CardHand -> GameInterface
- Reports played card events
- Updates hand size and composition
- Sends targeting information for card effects
- Notifies when cards are discarded

### PlayerHUD -> Battlefield
- Sends unit deployment commands
- Initiates combat actions
- Activates hero abilities
- Triggers structure placement

### GameInterface -> TurnManager
- Sends player action confirmations
- Reports turn completion
- Initiates phase transitions
- Processes crisis event responses

## State Update Rules

- Combat results must be processed before phase transitions
- Resource updates flow from TurnManager to all components
- Card effects resolve before unit actions
- Hero abilities can interrupt normal phase flow
- Crisis events take priority over standard actions

## Component Dependencies

```
Battlefield <-> TurnManager <-> PlayerHUD
     ^              ^             ^
     |              |             |
     v              v             v
CardHand ------> GameInterface <---
```

File paths:
- frontend-next/src/features/battlefield/Battlefield.tsx
- frontend-next/src/features/battlefield/TurnManager.tsx
- frontend-next/src/features/cards/CardHand.tsx
- frontend-next/src/components/game/GameInterface.tsx
- frontend-next/src/features/players/PlayerHUD.tsx
